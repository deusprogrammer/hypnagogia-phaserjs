/*! For license information please see main.490367c8b7e8f715dddb.bundle.js.LICENSE.txt */
(()=>{var e,t={354:(e,t,s)=>{"use strict";s(260);class i extends Phaser.Scene{constructor(){super({key:"ErrorScene"})}init({errorMessage:e}){this.errorMessage=e}create(){this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,this.errorMessage,{fontSize:"30pt",stroke:"#000",strokeThickness:5}).setOrigin(.5,.5)}update(){}}const a=48,o="down",n="left",r="right";class l extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i),e.add.existing(this),e.physics.add.existing(this),this.setOrigin(0,0),this.direction=n,this.block={x:0,y:0},this.center={x:0,y:0}}update(){super.update()}}class h extends l{constructor(e,t,s,i){super(e,t,s,i),this.setCollideWorldBounds(!0),this.adjacentBlock=this.scene.add.rectangle(5,5,38,38,16711680,.25),this.adjacentBlock.setOrigin(0,0),this.adjacentBlock.setDepth(99999)}update(){super.update(),this.center.x=this.x+24,this.center.y=this.y+24,this.block.x=Math.floor(this.center.x/a),this.block.y=Math.floor(this.center.y/a),this.depth=this.block.y,this.adjustForCollisions();let e=this.getFacingBlock();this.adjacentBlock.setPosition(e.x*a+5,e.y*a+5)}adjustForCollisions(){let e=this.scene,t=this.scene.physics.collide(this,[e.level.blocks,e.level.moveable]),s=this.scene.physics.overlap(this,[e.level.blocks,e.level.moveable]),i=this.getFacingBlock();if(t||s&&e.level.isBlockPassable(i.x,i.y)){let e=this.findDeltaFromPassing();Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))<=20&&this.adjustToCurrentBlock()}}adjustToCurrentBlock(){this.x=this.block.x*a,this.y=this.block.y*a}getFacingBlock(){let e={x:0,y:0};return"up"==this.direction?(e.x=this.block.x,e.y=this.block.y-1):"down"==this.direction?(e.x=this.block.x,e.y=this.block.y+1):"left"==this.direction?(e.x=this.block.x-1,e.y=this.block.y):"right"==this.direction&&(e.x=this.block.x+1,e.y=this.block.y),e}findDeltaFromPassing(){let e={center:{x:0,y:0}};e.center.x=this.block.x*a+24,e.center.y=this.block.y*a+24;let t={x:0,y:0};return t.x=Math.abs(this.center.x-e.center.x),t.y=Math.abs(this.center.y-e.center.y),t}}class c extends h{constructor(e,t,s,i){super(e,t,s,i)}update(){super.update(),this.isMoving&&(this.targetCoords.x?(this.x+=2*this.movingDirection,(this.movingDirection>0&&this.x>=this.targetCoords.x||this.movingDirection<0&&this.x<=this.targetCoords.x)&&(this.x=this.targetCoords.x,this.isMoving=!1)):this.targetCoords.y&&(this.y+=2*this.movingDirection,(this.movingDirection>0&&this.y>=this.targetCoords.y||this.movingDirection<0&&this.y<=this.targetCoords.y)&&(this.y=this.targetCoords.y,this.isMoving=!1)))}moveToX(e){this.isMoving||(this.targetCoords={x:e,y:null},this.movingDirection=this.x-this.targetCoords.x>0?-1:1,this.isMoving=!0,console.log(this.targetCoords),console.log({x:this.x,y:this.y}))}moveToY(e){this.isMoving||(this.targetCoords={x:null,y:e},this.movingDirection=this.y-this.targetCoords.y>0?-1:1,this.isMoving=!0,console.log(this.targetCoords),console.log({x:this.x,y:this.y}))}adjustForCollisions(){let e=this.scene,t=this.scene.physics.collide(this,[e.level.blocks,e.level.moveable]),s=this.scene.physics.overlap(this,[e.level.blocks,e.level.moveable]),i=this.getFacingBlock();if(t||s&&e.level.isBlockPassable(i.x,i.y)){let e=this.findDeltaFromPassing();Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))<=20&&this.adjustToCurrentBlock()}}}class d extends h{constructor(e,t,s,i){super(e,t,s,i),((e,t,s)=>{e.anims.create({key:"walk-down",frames:e.anims.generateFrameNumbers(t,{start:0,end:2}),frameRate:10,repeat:1}),e.anims.create({key:"walk-left",frames:e.anims.generateFrameNumbers(t,{start:3,end:5}),frameRate:10,repeat:1}),e.anims.create({key:"walk-right",frames:e.anims.generateFrameNumbers(t,{start:6,end:8}),frameRate:10,repeat:1}),e.anims.create({key:"walk-up",frames:e.anims.generateFrameNumbers(t,{start:9,end:11}),frameRate:10,repeat:1}),e.anims.create({key:"idle-down",frames:e.anims.generateFrameNumbers(t,{start:0,end:0}),frameRate:10,repeat:1}),e.anims.create({key:"idle-left",frames:e.anims.generateFrameNumbers(t,{start:3,end:3}),frameRate:10,repeat:1}),e.anims.create({key:"idle-right",frames:e.anims.generateFrameNumbers(t,{start:6,end:6}),frameRate:10,repeat:1}),e.anims.create({key:"idle-up",frames:e.anims.generateFrameNumbers(t,{start:9,end:9}),frameRate:10,repeat:1})})(this,i),this.hitBox=e.add.rectangle(this.center.x,this.center.y,this.width,this.height),this.scene.physics.add.existing(this.hitBox),this.hitBox.setOrigin(.5,.5)}update(){super.update(),this.hitBox.setPosition(this.center.x,this.center.y)}}class m extends d{constructor(e,t,s,i,a){super(e,t,s,i),this.scene=e,this.isStopped=!1,this.movementCallback=a,this.controls={up:this.scene.input.keyboard.addKey("W"),down:this.scene.input.keyboard.addKey("S"),left:this.scene.input.keyboard.addKey("A"),right:this.scene.input.keyboard.addKey("D")}}update(){this.controls.down.isDown?(this.direction=o,this.setVelocityX(0),this.setVelocityY(500),this.play("walk-down",!0),this.movementCallback(this),this.isStopped=!1):this.controls.up.isDown?(this.direction="up",this.setVelocityX(0),this.setVelocityY(-500),this.play("walk-up",!0),this.movementCallback(this),this.isStopped=!1):this.controls.right.isDown?(this.direction=r,this.setVelocityX(500),this.setVelocityY(0),this.play("walk-right",!0),this.movementCallback(this),this.isStopped=!1):this.controls.left.isDown?(this.direction=n,this.setVelocityX(-500),this.setVelocityY(0),this.play("walk-left",!0),this.movementCallback(this),this.isStopped=!1):(this.setVelocityX(0),this.setVelocityY(0),this.play(`idle-${this.direction}`),this.isStopped||(this.movementCallback(this),this.isStopped=!0)),super.update()}}class y extends m{constructor(e,t,s,i){super(e,t,s,"playerSprite",i),e.physics.add.collider(this,e.level.moveable,x)}update(){super.update()}}class p extends m{constructor(e,t,s,i){super(e,t,s,"mouseSprite",i),this.tint=5592405,this.hitBox.scale=.25}update(){super.update()}}class g extends d{constructor(e,t,s,i){super(e,t,s,i)}update(){super.update()}}class u extends g{constructor(e,t,s){super(e,t,s,"catSprite"),this.hitBox.scale=.25}update(){super.update()}}class k extends g{constructor(e,t,s){super(e,t,s,"monsterSprite"),this.tint=5592405,this.hitBox.scale=.25,e.physics.add.collider(this,e.level.moveable,x)}update(){super.update()}}let x=(e,t)=>{let s=e,i=t,l=s.scene;i.direction=s.direction;let h=i.getFacingBlock();if(console.log("PUSH "+s.direction),i.isMoving)return;let c=l.physics.overlapRect(h.x*a+5,h.y*a+5,38,38);switch(console.log("BODIES:   "+c),console.log("ADJACENT: "+h.x+", "+h.y),s.direction){case"up":if(!l.level.isBlockPassable(i.block.x,i.block.y-1)||c.length>0)return void console.log("UNPASSABLE");i.y-=a,l.level.clearTile(i.block.x,i.block.y),l.level.setTile(i.block.x,i.block.y-1);break;case o:if(!l.level.isBlockPassable(i.block.x,i.block.y+1)||c.length>0)return void console.log("UNPASSABLE");i.y+=a,l.level.clearTile(i.block.x,i.block.y),l.level.setTile(i.block.x,i.block.y+1);break;case n:if(!l.level.isBlockPassable(i.block.x-1,i.block.y)||c.length>0)return void console.log("UNPASSABLE");i.x-=a,l.level.clearTile(i.block.x,i.block.y),l.level.setTile(i.block.x-1,i.block.y);break;case r:if(!l.level.isBlockPassable(i.block.x+1,i.block.y)||c.length>0)return void console.log("UNPASSABLE");i.x+=a,l.level.clearTile(i.block.x,i.block.y),l.level.setTile(i.block.x+1,i.block.y)}};var b=s(840);class v extends Phaser.Scene{create(){this.isPaused=!1}}const f={level1:{tilemap:[["|","*","*","*","*","|","*","*","*","*","O","*","*","*","|"],["|"," "," "," "," ","|"," ","H","R","R"," ","B"," "," ","|"],["|"," "," "," "," ","|"," "," "," "," "," "," "," "," ","|"],["|"," "," "," "," ","|"," ","B"," ","B"," ","H"," ","B","|"],["|"," "," "," "," ","|"," "," "," "," "," "," "," "," ","|"],["|"," "," ","H"," ","*"," ","B","R","H"," ","R"," ","B","|"],["|"," "," "," ","#"," "," "," "," "," "," "," "," "," ","|"],["|","*","*","O","*","*"," ","*","*","O","*","*"," "," ","|"],["|"," "," "," "," "," "," "," ","#"," ","#"," "," "," ","|"],["|"," "," "," "," ","H"," ","|"," "," "," "," "," "," ","|"],["|"," "," "," "," "," "," ","|"," "," ","#"," "," "," ","|"],["|"," "," "," "," "," "," ","|"," "," "," "," "," "," ","|"],["E"," "," "," "," "," "," ","|"," "," "," "," "," "," ","|"],["|"," "," ","H"," ","B"," ","|"," ","R"," ","B"," "," ","|"],["|","|","|","|","|","|","|","|","|","|","|","|","|","|","|"]],blocksX:15,blocksY:15,player1Start:{x:1,y:1},player2Start:{x:13,y:1},floorAsset:"floor1",nightTint:12533951,nextLevel:"level2"}};let S={"*":{name:"wall1",file:"assets/img/wall1.png",canPush:!1,canHide:!1,isExit:!1},H:{name:"table2",file:"assets/img/table2.png",canPush:!1,canHide:!0,isExit:!1},"|":{name:"wall2",file:"assets/img/wall2.png",canPush:!1,canHide:!1,isExit:!1},E:{name:"door",file:"assets/img/door.png",canPush:!1,canHide:!1,isExit:!0},B:{name:"box",file:"assets/img/box.png",canPush:!1,canHide:!1,isExit:!1},"#":{name:"table",file:"assets/img/table.png",canPush:!0,canHide:!1,isExit:!1},S:{name:"skeleton",file:"assets/img/skeleton.png",canPush:!1,canHide:!1,isExit:!1},R:{name:"barrel",file:"assets/img/barrel.png",canPush:!1,canHide:!1,isExit:!1},O:{name:"hole",file:"assets/img/hole.png",canPush:!1,canHide:!0,isExit:!1}};class w extends Phaser.GameObjects.GameObject{constructor(e,t){super(e,"level"),this.levelConfig=t,e.add.existing(this),this.floor=this.scene.add.group(),this.blocks=this.scene.physics.add.group(),this.moveable=this.scene.physics.add.group(),this.hidingSpots=this.scene.physics.add.group();for(let t=0;t<this.levelConfig.blocksY;t++)for(let s=0;s<this.levelConfig.blocksX;s++){let i=this.scene.add.image(s*a,t*a,this.levelConfig.floorAsset);"night"===e.cycle&&(i.tint=this.levelConfig.nightTint),this.floor.add(i);let o,n=S[this.levelConfig.tilemap[t][s]];n&&(n.canPush?(o=new c(e,s*a,t*a,n.name),this.moveable.add(o)):n.canHide?(o=e.physics.add.sprite(s*a,t*a,n.name),"night"===e.cycle?this.hidingSpots.add(o):this.blocks.add(o)):n.isExit&&!this.exit?(o=e.physics.add.sprite(s*a,t*a,n.name),this.exit=o):(o=e.physics.add.sprite(s*a,t*a,n.name),this.blocks.add(o)),o.depth=t*a+5,o.setOrigin(0,0),o.setPushable(!1),"night"===e.cycle&&(o.tint=this.levelConfig.nightTint))}}getTile(e,t){return this.levelConfig.tilemap[t][e]}clearTile(e,t){this.levelConfig.tilemap[t][e]=" "}setTile(e,t){this.levelConfig.tilemap[t][e]="#"}isBlockPassable(e,t){return e>=0&&t>=0&&e<this.levelConfig.blocksX&&t<this.levelConfig.blocksY&&" "===this.getTile(e,t)}isBlockPassableAndNotBreakable(e,t){return e>=0&&t>=0&&e<this.levelConfig.blocksX&&t<this.levelConfig.blocksY&&"*"!==this.getTile(e,t)}isBlockBreakable(e,t){return"#"===this.getTile(e,t)}update(){this.blocks.children.each((e=>{e.update()}),this),this.moveable.children.each((e=>{e.update()}),this)}}let T=new URLSearchParams(window.location.search).get("sessionId")||"";const O={night:{win:"You survived...\ntomorrow a new day awaits\nawaits...",lose:"The cold paw of death\nhas consumed you...",time:"The morning sun...\nbreaks through the dark...\nbut the same morning awaits."},day:{win:"You got the key...\nbut night\nsnuffs out\nthe light of day.",lose:"You failed...\na night of terror awaits...",time:"You are out of time...\nnight draws near..."}};let C=new URLSearchParams(window.location.search).get("cycle");class P extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.graphics=this.add.graphics(),this.newGraphics=this.add.graphics(),this.load.on("progress",(e=>{this.newGraphics.clear(),this.newGraphics.fillStyle(3508194,1),this.newGraphics.fillRectShape(new Phaser.Geom.Rectangle(205,205,390*e,40)),e*=100,this.loadingText.setText("Hypnagogia\nLoading: "+e.toFixed(2)+"%")})),this.load.spritesheet("playerSprite","assets/img/player.png",{frameWidth:a,frameHeight:a}),this.load.spritesheet("catSprite","assets/img/cat.png",{frameWidth:a,frameHeight:a}),this.load.spritesheet("mouseSprite","assets/img/mouse.png",{frameWidth:a,frameHeight:a}),this.load.spritesheet("monsterSprite","assets/img/monster.png",{frameWidth:a,frameHeight:a}),this.load.image("button","assets/img/button.png"),this.load.image("panel","assets/img/panel.png"),this.load.image("floor1","assets/img/floor.png"),this.load.audio("night-music","assets/music/night.mp3"),this.load.audio("day-music","assets/music/day.mp3");let e=new Phaser.Geom.Rectangle(200,200,400,50),t=new Phaser.Geom.Rectangle(205,205,290,40);this.graphics.fillStyle(16777215,1),this.graphics.fillRectShape(e),this.newGraphics.fillStyle(3508194,1),this.newGraphics.fillRectShape(t),this.loadingText=this.add.text(250,260,"Loading: ",{fontSize:"32px",color:"0xFFF"}),Object.keys(S).forEach((e=>{let t=S[e];this.load.image(t.name,t.file),console.log("LOADING: "+t.name+" => "+t.file)}))}updateBar(e){}create(){this.scene.start("CycleScene",{cycle:C})}}class D{constructor(e,t,s){this.elements=new Set,this.panel=e.add.image(t,s,"panel"),this.elements.add(this.panel),this.headerText=e.add.text(t-100,s-145,"What is up, mah dudes",{fontSize:"16px",color:"#000",backgroundColor:"#eeeeee"}),this.elements.add(this.headerText),this.buttonLightScene=e.add.image(t,s-50,"button").setInteractive(),this.elements.add(this.buttonLightScene),this.buttonLightSceneText=e.add.text(this.buttonLightScene.x-30,this.buttonLightScene.y-8,"Light Scene",{fontSize:"10px",color:"#eeeeee"}),this.elements.add(this.buttonLightSceneText),this.buttonDarkScene=e.add.image(t,s+30,"button").setInteractive(),this.elements.add(this.buttonDarkScene),this.buttonDarkSceneText=e.add.text(this.buttonDarkScene.x-30,this.buttonDarkScene.y-8,"Dark Scene",{fontSize:"10px",color:"#eeeeee"}),this.elements.add(this.buttonDarkSceneText),this.buttonStartScene=e.add.image(t,s+110,"button").setInteractive(),this.elements.add(this.buttonStartScene),this.buttonStartSceneText=e.add.text(this.buttonStartScene.x-30,this.buttonStartScene.y-8,"Start Scene",{fontSize:"10px",color:"#eeeeee"}),this.elements.add(this.buttonStartSceneText),this.buttonLightScene.on("pointerdown",(function(){console.log("button1"),e.scene.start("DayCycleScene")})),this.buttonDarkScene.on("pointerdown",(function(){console.log("button2"),e.scene.start("NightCycleScene")})),this.buttonStartScene.on("pointerdown",(function(){console.log("button3"),e.scene.start("StartScene")}))}disableUI(){Array.from(this.elements).forEach((e=>{e.destroy()}))}}class B extends Phaser.Scene{constructor(){super({key:"StartScene"}),this.state="PLAYING"}create(){this.menu=new D(this,600,350)}}class E extends Phaser.Scene{constructor(){super({key:"DayToNightScene"})}create(){this.cameras.main.setBackgroundColor("#000000"),this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,"Falling Asleep...Sweet Dreams",{fontSize:"30pt",stroke:"#000",strokeThickness:5}),setTimeout((()=>{this.scene.start("CycleScene",{cycle:"night"})}),1e4)}}class I extends Phaser.Scene{constructor(){super({key:"NightToDayScene"})}create(){this.cameras.main.setBackgroundColor("#FFFFFF"),this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,"Waking Up...Good Morning!",{fontSize:"30pt",stroke:"#000",strokeThickness:5}),setTimeout((()=>{this.scene.start("CycleScene",{cycle:"day"})}),1e4)}update(e,t){}}class A extends Phaser.Scene{constructor(){super("UIScene")}init({timeRemaining:e,cycle:t,onTimeout:s}){this.timeRemaining=e,this.cycle=t,this.onTimeout=s}create(){this.timerElement=this.add.text(50,50,`You have ${this.timeRemaining}s to find the ${"day"===this.cycle?"cat":"door"}`,{fontSize:"20pt",stroke:"#000",strokeThickness:5}),this.timerElement.setOrigin(0,1),this.timerElement.depth=9999,this.timerElement.setScrollFactor(0,0),this.timerInterval=setInterval((()=>{this.timeRemaining--,0===this.timeRemaining&&(clearInterval(this.timerInterval),this.onTimeout()),this.timerElement.setText(`You have ${this.timeRemaining}s to find the ${"day"===this.cycle?"cat":"door"}`)}),1e3)}update(){}}const N={type:Phaser.AUTO,backgroundColor:"#ffffff",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1280,height:720},scene:[P,class extends v{constructor(){super({key:"CycleScene"}),this.state="WAITING",this.levelId="level1",this.timeRemaining=30}onPlayerMove(e,t){let{direction:s,x:i,y:a,body:{velocity:{x:o,y:n}}}=e;t.send(JSON.stringify({type:"UPDATE",sessionId:T,player:this.cycle,playerData:{direction:s,x:i,y:a,velocity:{x:o,y:n},currentAnimation:e.anims.currentAnim.key}}))}onRemoteMove({playerData:{x:e,y:t,direction:s,currentAnimation:i,velocity:a},gameState:o}){"YOU_LOST"===o?this.onLose():"YOU_WON"===o&&this.onWon(),this.remote.x=e,this.remote.y=t,this.remote.direction=s,this.remote.play(i,!0)}onLose(){let e=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,O[this.cycle].lose,{fontSize:"30pt",stroke:"#000",strokeThickness:5});e.depth=999,e.setOrigin(.5,.5),this.cameras.main.zoomTo(1),this.cameras.main.stopFollow(),this.cameras.main.centerOn(.5*this.game.scale.width,.5*this.game.scale.height),clearInterval(this.timerInterval),this.transition()}onWon(){let e=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,O[this.cycle].win,{fontSize:"30pt",stroke:"#000",strokeThickness:5});e.depth=999,e.setOrigin(.5,.5),this.cameras.main.zoomTo(1),this.cameras.main.stopFollow(),this.cameras.main.centerOn(.5*this.game.scale.width,.5*this.game.scale.height),clearInterval(this.timerInterval),this.transition()}onTimeout(){let e=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,O[this.cycle].time,{fontSize:"30pt",stroke:"#000",strokeThickness:5});e.depth=999,e.setOrigin(.5,.5),this.cameras.main.zoomTo(1),this.cameras.main.stopFollow(),this.cameras.main.centerOn(.5*this.game.scale.width,.5*this.game.scale.height),clearInterval(this.timerInterval),this.transition()}transition(){setTimeout((()=>{"day"===this.cycle?this.scene.start("DayToNightScene"):this.scene.start("NightToDayScene")}),5e3)}init({cycle:e}){this.cycle=e}create(){let e,t;"day"===this.cycle?(this.cameras.main.setBackgroundColor("#FFFFFF"),e=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,"Waking Up...",{fontSize:"30pt",stroke:"#000",strokeThickness:5}),e.setOrigin(.5,.5)):"night"===this.cycle&&(this.cameras.main.setBackgroundColor("#000000"),e=this.add.text(.5*this.game.scale.width,.5*this.game.scale.height,"Falling Asleep...Sweet Dreams",{fontSize:"30pt",stroke:"#000",strokeThickness:5}),e.setOrigin(.5,.5));try{let s;t=this.ws=new b.w3cwebsocket("wss:/deusprogrammer.com/ws/hypnagogia"),this.ws.onopen=()=>{console.log("CONNECTED TO WEBSOCKET"),this.ws.send(JSON.stringify({type:"CONNECT",sessionId:T,player:this.cycle,playerData:{x:0,y:0,direction:"DOWN",currentAnimation:"IDLE",state:"ALIVE"}})),s=setInterval((()=>{this.ws.send(JSON.stringify({type:"PING",sessionId:T,player:this.cycle,playerData:{x:0,y:0,direction:"DOWN",currentAnimation:"IDLE",state:"ALIVE"}}))}),1e4)},this.ws.onmessage=s=>{let i=JSON.parse(s.data);switch(this.game.scale.setGameSize(f[this.levelId].blocksX*a,f[this.levelId].blocksY*a),i.type){case"READY":console.log("OTHER PLAYER READY"),this.state="PLAYING",this.level=new w(this,f[this.levelId]),this.scene.launch("UIScene",{timeRemaining:this.timeRemaining,cycle:this.cycle,onTimeout:()=>{this.onTimeout()}}),"day"===this.cycle?(this.music=this.sound.add("day-music"),this.music.play(),this.player=new y(this,f[this.levelId].player1Start.x*a,f[this.levelId].player1Start.y*a,(e=>{this.onPlayerMove(e,t)})),this.remote=new u(this,f.level1.player2Start.x*a,f.level1.player2Start.y*a),this.physics.add.collider(this.player.hitBox,this.remote.hitBox,(()=>{this.onWon(),t.send(JSON.stringify({type:"UPDATE",sessionId:T,player:this.cycle,playerData:{direction:this.player.direction,x:this.player.x,y:this.player.y,velocity:{x:this.player.body.velocity.x,y:this.player.body.velocity.y},currentAnimation:this.player.anims.currentAnim.key},gameState:"YOU_LOST"}))})),this.physics.add.collider(this.remote,this.level.exit,(()=>{this.onLose(),t.send(JSON.stringify({type:"UPDATE",sessionId:T,player:this.cycle,playerData:{direction:this.player.direction,x:this.player.x,y:this.player.y,velocity:{x:this.player.body.velocity.x,y:this.player.body.velocity.y},currentAnimation:this.player.anims.currentAnim.key},gameState:"YOU_WON"})),setTimeout((()=>{this.scene.start("DayToNightScene")}),5e3)})),this.cameras.main.startFollow(this.player),this.cameras.main.zoom=2):"night"===this.cycle&&(this.music=this.sound.add("night-music"),this.music.play(),this.player=new p(this,f[this.levelId].player2Start.x*a,f[this.levelId].player2Start.y*a,(e=>{this.onPlayerMove(e,t)})),this.remote=new k(this,f[this.levelId].player1Start.x*a,f[this.levelId].player1Start.y*a),this.physics.add.collider(this.remote.hitBox,this.player.hitBox,(()=>{this.onLose(),t.send(JSON.stringify({type:"UPDATE",sessionId:T,player:this.cycle,playerData:{direction:this.player.direction,x:this.player.x,y:this.player.y,velocity:{x:this.player.body.velocity.x,y:this.player.body.velocity.y},currentAnimation:this.player.anims.currentAnim.key},gameState:"YOU_WON"}))})),this.physics.add.collider(this.player,this.level.exit,(()=>{this.onWon(),t.send(JSON.stringify({type:"UPDATE",sessionId:T,player:this.cycle,playerData:{direction:this.player.direction,x:this.player.x,y:this.player.y,velocity:{x:this.player.body.velocity.x,y:this.player.body.velocity.y},currentAnimation:this.player.anims.currentAnim.key},gameState:"YOU_LOST"})),setTimeout((()=>{this.scene.start("NightToDayScene")}),5e3)})),this.cameras.main.startFollow(this.player),this.cameras.main.zoom=4),e.destroy();break;case"UPDATE":this.onRemoteMove(i)}},this.ws.onclose=()=>{console.log("SOCKET CLOSED"),clearInterval(s),this.scene.start("ErrorScene",{errorMessage:"Socket closed"})},this.ws.onerror=()=>{console.log("ERROR"),clearInterval(s),this.scene.start("ErrorScene",{errorMessage:"Socket failure"})}}catch(e){console.log("CAUGHT ERROR: "+e),this.scene.start("ErrorScene",{errorMessage:e})}}update(){"PLAYING"===this.state&&(this.player.update(),this.remote.update(),this.level.update())}},i,B,E,I,A],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:0}}}};window.addEventListener("load",(()=>{new Phaser.Game(N)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},s={};function i(e){var a=s[e];if(void 0!==a)return a.exports;var o=s[e]={exports:{}};return t[e].call(o.exports,o,o.exports,i),o.exports}i.m=t,e=[],i.O=(t,s,a,o)=>{if(!s){var n=1/0;for(c=0;c<e.length;c++){for(var[s,a,o]=e[c],r=!0,l=0;l<s.length;l++)(!1&o||n>=o)&&Object.keys(i.O).every((e=>i.O[e](s[l])))?s.splice(l--,1):(r=!1,o<n&&(n=o));if(r){e.splice(c--,1);var h=a();void 0!==h&&(t=h)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,a,o]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,o,[n,r,l]=s,h=0;if(n.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var c=l(i)}for(t&&t(s);h<n.length;h++)o=n[h],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(c)},s=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.O(void 0,[216],(()=>i(354)));var a=i.O(void 0,[216],(()=>i(204)));a=i.O(a)})();